[{"title":"HBase-简介","url":"/2019/03/24/bigdata/HBase-简介/","content":"** {{ title }}：** <Excerpt in index | 首页摘要>\n大数据组件-列式数据库 HBase\n<!-- more -->\n<The rest of contents | 余下全文>\n\n# HBase-简介\n\n1、HBase是一个分布式的、持久的、强一致性的存储系统，具有近视最优的写性能（能使IO利用率达到饱和）和出色的读性能。\n\n2、支持特定列族切换可选压缩算法。\n\n3、只考虑单一索引，提供服务器端钩子，可实施辅助索引解决方案。\n\n4、提供过滤器功能，减少网络传输的数据量。\n\n\n\n## 1、HBase结构\n\n### 1.1、表、行、列、单元格\n\n最基本的单位是列。\n\n1、一个表中有若干行，每列可能有多个版本，每个单元格中存储了不同的值，一列或多列形成一行，并由唯一的行键来确定存储。\n\n2、行序按照行键的字典排序进行排序，行键唯一。字典序中是按照二进制逐字节从左到右依次对比每个行键排序。\n\n3、一个列族的所有列存储在同一个底层的存储文件里，这个存储文件叫做HFile。\n\n\n\n列族、列、单元格：\n\n1、列族需在创建表时就定义好，且不能频繁修改，数量不能过多。\n\n2、列族名必须由可打印字符组成。\n\n3、一个列族可以有数百万个列。\n\n4、列值没有类型和长度限制。\n\n5、列或单元格的值都有时间戳、默认由系统指定，用户可显示设置。\n\n6、一个单元格的不同版本的值按照降序排列在一起，访问的时候优先读取最新的值。\n\n行：\n\n1、行看作是所有列以及这些列的最新版本的组合。\n\n2、行数据的存取操作是原子的，可任意读写任意数目的列。\n\n3、目前不支持跨行事物和跨表事物。\n\n示例数据存储模式：SortMap<RowKey, List<SortedMap,<Column, List<Value, Timestamp>>>>\n\nNULL说明：固定模式数据库在没有值的地方必须存储NULL值，HBase的存储架构中，可以省略整个列，空值不占用任何存储空间。\n\n### 1.2、自动分区\n\nHBase中扩展和负载的基本单元是region，region本质是行键排序的连续存储的区间。当region太大，系统将其动态才分。相反，就把多个region合并，减少存储文件数量（HBase不支持在线region合并，有离线出来合并工具，后期讨论）。\n\n\n\n## 1.3、实现\n\n1、数据（键值映射结构）经过排序存储在存储文件HFile中（HFile存储在磁盘）。\n\n2、HFile文件内部由连续的块组成，块的索引信息存储在文件尾部（块64KB）。\n\n3、更新数据时，先将数据记录在提交日志中（预写日志WAL），然后将数据写入内存中的memstore中（行键已排序）。\n\n4、内存写入数据超过给定最大值时，数据将做为HFile写入到磁盘，数据移出内存后丢弃对应的提交日志，只保留为持久化的提交日志。\n\n5、删除标记：存储文件是不可被改变的，无法通过移除某个键值对来简单的删除值。解决办法是做删除标记，表明给定行已被删除。在检索时，标记掩盖了实际值，客户端读不到实际值。\n\n6、返回值：读回的数据是memstore和磁盘存储文件的数据合并结果。\n\n7、WAL：服务器内存数据在服务器崩溃前未写入时，用WAL来进行数据恢复。\n\n8、HFile合并：minor合并和major压缩合并。\n\n​\tminor将多个小文件重写为比较少的文件，实际是多路归并的过程。因为HFile的每个文件都是经过归类的，仅受磁盘IO影响。\n\n​\tmajor将一个region中的一个列族的若干个HFile重写为一个新HFile。与minor合并相比，mojor合并能扫描所有键值对，顺序重写全部的数据，在此过程中将忽略做删除标记的数据，即重写数据时不再写入磁盘。\n\n","tags":["HBase"],"categories":["bigdata"]},{"title":"About","url":"/2019/03/24/About/","content":"** {{ title }}：** <Excerpt in index | 首页摘要>\n个人笔记博客，记录下生活、工作中的点滴。\n<!-- more -->\n<The rest of contents | 余下全文>\n\n先立下flag，后期再逐步更新。\n\n```\n1、java\n2、goland\n3、微服务组件\n\tAPI网关\n\t配置中心\n\t注册中心\n\t通讯组件\n\t分布式事物\n4、大数据组件\n\tHDFS\n\tHBase\n\tStorm\n\tSpark\n5、AI-技术调研\n5、杂记\n```","tags":["about"],"categories":["about"]}]